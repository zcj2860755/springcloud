<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zdzc.dao.TSysProjectMapper">
  <resultMap id="BaseResultMap" type="com.zdzc.model.TSysProject">
    <!--
      WARNING - @mbg.generated
    -->
    <result column="id" jdbcType="VARCHAR" property="id" />
    <result column="parent_id" jdbcType="VARCHAR" property="parentId" />
    <result column="cascade_id" jdbcType="VARCHAR" property="cascadeId" />
    <result column="pro_code" jdbcType="VARCHAR" property="proCode" />
    <result column="pro_name" jdbcType="VARCHAR" property="proName" />
    <result column="contacts" jdbcType="VARCHAR" property="contacts" />
    <result column="is_leaf" jdbcType="INTEGER" property="isLeaf" />
    <result column="orders" jdbcType="VARCHAR" property="orders" />
    <result column="remark" jdbcType="VARCHAR" property="remark" />
    <result column="is_enable" jdbcType="INTEGER" property="isEnable" />
    <result column="create_time" jdbcType="TIMESTAMP" property="createTime" />
    <result column="account_id" jdbcType="VARCHAR" property="accountId" />
  </resultMap>


  <sql id="Base_Column_List" >
    id,parent_id,cascade_id,pro_code,pro_name,contacts,is_leaf,orders,remark,is_enable,create_time,account_id
  </sql>

  <select id="selectParamsBySreach" resultMap="BaseResultMap">

  select
  <include refid="Base_Column_List" />
  from t_sys_project
  <where>
    <if test="searchContent != null">
      (pro_name like concat('%',#{searchContent},'%') or pro_code like concat('%',#{searchContent},'%'))
    </if>
    <if test="id!=null">
      and id = #{id}
    </if>
    <if test="cascadeId!=null">
      and (cascade_id  like concat('%',#{cascadeId},'%') or id = #{cascadeId})
    </if>
  </where>
    order by orders
 </select>


  <select id="selectParamsNot" resultMap="BaseResultMap">

    select
    <include refid="Base_Column_List" />
    from t_sys_project
    <where>
      <if test="id != null">
        id != #{id}
      </if>
      <if test="parentId!=null">
        and parent_id = #{parentId}
      </if>
    </where>
    order by orders
  </select>

  <update id="updateByExampleSelective">

    update  t_sys_project
    <set>
      <if test="cascadeId!=null">
        cascade_id = #{cascadeId}
      </if>

      <if test="parentId!=null">
        parent_id = #{parentId}
      </if>

      <if test="proCode!=null">
        pro_code = #{proCode}
      </if>

      <if test="proName!=null">
        pro_name = #{proName}
      </if>

      <if test="contacts!=null">
        contacts = #{contacts}
      </if>

      <if test="isLeaf!=null">
        is_leaf = #{isLeaf}
      </if>

      <if test="orders!=null">
        orders = #{orders}
      </if>

      <if test="remark!=null">
        remark = #{remark}
      </if>

      <if test="isEnable!=null">
        is_enable = #{isEnable}
      </if>

      <if test="accountId!=null">
        account_id = #{accountId}
      </if>

    </set>
  </update>

  <select id="selectProjectByIdAndCascade" resultType="java.lang.String">
    select id from t_sys_project
    <where>
      is_enable = 0
      <if test="id != null and cascadeId != null">
        and (id=#{id} or cascade_id  like concat('%',#{cascadeId},'%'))
      </if>
      <if test="id != null and cascadeId == null">
        and id=#{id}
      </if>
    </where>
  </select>


  <select id="selectProjectNameCount" resultType="java.lang.Integer">
    select count(1) from t_sys_project
    <where>
      <if test="proName != null">
        pro_name=#{proName}
      </if>
      <if test="id != null">
        and id !=#{id}
      </if>
    </where>
  </select>
</mapper>
